# 作业1:线性模型和支持向量机

**姓名**: 杨憬晗  
**学号**: 2022010808

---

## 线性模型与梯度下降

### 2.1 特征归一化

在实际任务中，若各维特征的量级差异较大，梯度下降的收敛会显著变慢；同时，在使用正则化时，量级较大的特征对正则项影响更强。因此需要进行特征归一化。常用做法是在训练集上对每个特征进行仿射变换，将其映射到区间[0,1]；并对测试集施加与训练集一致的变换。

#### 2.1.1 补全函数split_data，将数据集划分为训练集与测试集

**实现思路**：
- 根据`split_size`中的比例，依次计算每个划分的样本数量
- 使用索引切片将数据集划分为多个部分
- 处理最后一个划分以确保包含所有剩余样本

**代码实现**：
```python
start_idx = 0
for ratio in split_size:
    # Calculate the number of samples for this split
    split_num = int(num_instances * ratio)
    end_idx = start_idx + split_num
    
    # Handle the last split to include all remaining samples
    if end_idx > num_instances or ratio == split_size[-1]:
        end_idx = num_instances
    
    # Split the data
    X_list.append(X[start_idx:end_idx])
    y_list.append(y[start_idx:end_idx])
    
    start_idx = end_idx

return X_list, y_list
```

**关键点**：
- 使用累积索引方式进行数据划分
- 最后一个划分需要包含所有剩余样本，避免因浮点数计算导致的样本丢失

#### 2.1.2 补全函数feature_normalization，实现特征归一化

**实现思路**：
- 在训练集上计算每个特征的最小值和最大值
- 使用Min-Max归一化公式: \( x_{norm} = \frac{x - x_{min}}{x_{max} - x_{min}} \)
- 对测试集使用训练集的最小值和最大值进行相同的变换

**代码实现**：
```python
# Calculate min and max for each feature from the training set
train_min = np.min(train, axis=0)
train_max = np.max(train, axis=0)

# Avoid division by zero: if max == min, the feature is constant
# In this case, we can set the normalized value to 0 or keep it as is
range_vals = train_max - train_min
range_vals[range_vals == 0] = 1  # Avoid division by zero

# Normalize training set to [0, 1]
train_normalized = (train - train_min) / range_vals

# Apply the same transformation to test set using training set's min and max
test_normalized = (test - train_min) / range_vals

return train_normalized, test_normalized
```

**关键点**：
1. **统计量的计算**：所有归一化参数（最小值、最大值）都从训练集计算得出
2. **测试集一致性**：测试集必须使用训练集的统计量进行变换，确保分布一致
3. **边界情况处理**：当某个特征的最大值等于最小值时（常数特征），设置范围为1以避免除零错误
4. **向量化操作**：使用numpy的广播机制，对所有特征同时进行归一化，提高效率

**理论依据**：
- Min-Max归一化将特征线性映射到[0,1]区间
- 通过仿射变换 \( x' = \frac{x - min}{max - min} \) 实现
- 保证所有特征处于相同量级，有利于梯度下降的收敛
- 在正则化时，避免量级大的特征主导正则项

